import Book from "../src/book/book";
import assert from "assert";

describe('Book', function() {

	before(function(){

	});

	it('should open an opf file', function() {
		let book = new Book("/fixtures/alice/OPS/package.opf");

		return book.opened.then(function(){
			assert.equal( book.isOpen, true, "book is opened" );

			assert.equal( book.url.toString(), "http://localhost:9876/fixtures/alice/OPS/package.opf", "book url is passed to new Book" );
		});
	});

	describe('#toObject', function() {

		it('should export an opf file to a manifest object', function() {
			let book = new Book("/fixtures/alice/OPS/package.opf");

			return book.ready.then(function(){
				let object = book.toObject();
				assert.equal( object.metadata.title, "Alice's Adventures in Wonderland" );
				assert.equal( object.toc.length, 11);
				assert.equal( object.resources.length, 42 );
				assert.equal( object.spine.length, 13 );
				assert.equal( object.landmarks.length, 0 );
			});
		});

	});

	describe('#toJSON', function() {

		it('should export an opf file to a manifest json', function() {
			let book = new Book("/fixtures/alice/OPS/package.opf");

			return book.ready.then(function(){
				let json = book.toJSON();
				// console.log(json);
				assert.equal( json, `{"metadata":{"title":"Alice's Adventures in Wonderland","creator":"Lewis Carroll","description":"","pubdate":"","publisher":"","identifier":"edu.nyu.itp.future-of-publishing.alice-in-wonderland","language":"en-US","rights":"Public domain in the USA.","modified_date":"2012-01-18T12:47:00Z","layout":"","orientation":"","flow":"","viewport":"","direction":null,"@type":"http://schema.org/Book"},"spine":[{"idref":"cover","linear":false,"href":"http://localhost:9876/fixtures/alice/OPS/cover.xhtml","source":"cover.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/cover.xhtml"},{"idref":"toc","linear":false,"href":"http://localhost:9876/fixtures/alice/OPS/toc.xhtml","source":"toc.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/toc.xhtml"},{"idref":"titlepage","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/titlepage.xhtml","source":"titlepage.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/titlepage.xhtml"},{"idref":"chapter_001","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_001.xhtml","source":"chapter_001.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_001.xhtml"},{"idref":"chapter_002","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_002.xhtml","source":"chapter_002.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_002.xhtml"},{"idref":"chapter_003","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_003.xhtml","source":"chapter_003.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_003.xhtml"},{"idref":"chapter_004","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_004.xhtml","source":"chapter_004.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_004.xhtml"},{"idref":"chapter_005","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_005.xhtml","source":"chapter_005.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_005.xhtml"},{"idref":"chapter_006","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_006.xhtml","source":"chapter_006.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_006.xhtml"},{"idref":"chapter_007","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_007.xhtml","source":"chapter_007.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_007.xhtml"},{"idref":"chapter_008","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_008.xhtml","source":"chapter_008.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_008.xhtml"},{"idref":"chapter_009","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_009.xhtml","source":"chapter_009.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_009.xhtml"},{"idref":"chapter_010","linear":true,"href":"http://localhost:9876/fixtures/alice/OPS/chapter_010.xhtml","source":"chapter_010.xhtml","type":"application/xhtml+xml","canonical":"http://localhost:9876/fixtures/alice/OPS/chapter_010.xhtml"}],"resources":[{"href":"http://localhost:9876/fixtures/alice/OPS/toc.xhtml","type":"application/xhtml+xml","properties":["nav"],"source":"http://localhost:9876/fixtures/alice/OPS/toc.xhtml","rel":"contents"},{"href":"http://localhost:9876/fixtures/alice/OPS/cover.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/cover.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/css/stylesheet.css","type":"text/css","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/css/stylesheet.css"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/cover_th.jpg","type":"image/jpeg","properties":["cover-image"],"source":"http://localhost:9876/fixtures/alice/OPS/images/cover_th.jpg","rel":"cover"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i001_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i001_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i002_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i002_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i003_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i003_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i004_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i004_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i005_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i005_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i006_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i006_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i007_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i007_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i008_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i008_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i009_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i009_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i010_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i010_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i011_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i011_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i012_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i012_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i013_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i013_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i014_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i014_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i015_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i015_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i016_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i016_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i017_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i017_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i018_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i018_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i019_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i019_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i020_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i020_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/i022_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/i022_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/ii021_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/ii021_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/plate01_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/plate01_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/plate02_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/plate02_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/plate03_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/plate03_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/plate04_th.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/plate04_th.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/images/title.jpg","type":"image/jpeg","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/images/title.jpg"},{"href":"http://localhost:9876/fixtures/alice/OPS/titlepage.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/titlepage.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_001.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_001.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_002.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_002.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_003.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_003.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_004.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_004.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_005.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_005.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_006.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_006.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_007.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_007.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_008.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_008.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_009.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_009.xhtml"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_010.xhtml","type":"application/xhtml+xml","properties":[],"source":"http://localhost:9876/fixtures/alice/OPS/chapter_010.xhtml"}],"toc":[{"href":"http://localhost:9876/fixtures/alice/OPS/titlepage.xhtml","title":"Title Page"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_001.xhtml","title":"Down The Rabbit-Hole"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_002.xhtml","title":"The Pool Of Tears"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_003.xhtml","title":"A Caucus-Race And A Long Tale"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_004.xhtml","title":"The Rabbit Sends In A Little Bill"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_005.xhtml","title":"Advice From A Caterpillar"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_006.xhtml","title":"Pig And Pepper"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_007.xhtml","title":"A Mad Tea-Party"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_008.xhtml","title":"The Queen's Croquet Ground"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_009.xhtml","title":"Who Stole The Tarts?"},{"href":"http://localhost:9876/fixtures/alice/OPS/chapter_010.xhtml","title":"Alice's Evidence"}],"landmarks":[],"pageList":[],"@context":"http://readium.org/webpub/default.jsonld","links":[{"rel":"self","href":"/fixtures/alice/OPS/manifest.json","type":"application/webpub+json"}]}` );
			});
		});

	});


});
